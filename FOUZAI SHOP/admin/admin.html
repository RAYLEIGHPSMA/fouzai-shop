<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>لوحة التحكم - Fouzai Shop</title>
<link rel="stylesheet" href="../style.css">
<style>
/* تصميم Admin Panel */
.admin-section {
    max-width: 600px;
    margin: 20px auto;
    background: #fff0f5;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(255,105,180,0.3);
}

.admin-section input {
    width: 100%;
    padding: 10px;
    margin: 8px 0;
    border-radius: 10px;
    border: 1px solid #ff69b4;
}

.admin-section button {
    width: 100%;
    margin-top: 10px;
}

#admin-products-container ul {
    list-style: none;
    padding: 0;
}

#admin-products-container li {
    background: #ffb6c1;
    margin: 5px 0;
    padding: 10px;
    border-radius: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

#admin-products-container li button {
    background: #ff1493;
    border: none;
    color: white;
    padding: 5px 10px;
    border-radius: 10px;
    cursor: pointer;
    margin-left: 5px;
}
#admin-products-container li button:hover {
    background: #ff69b4;
}

#buyers-container {
    margin-top: 20px;
    background: #ffe4e1;
    padding: 10px;
    border-radius: 10px;
}
</style>
</head>
<body>
<header>
    <h1>لوحة التحكم - Fouzai Shop</h1>
</header>

<main>
    <section class="admin-section">
        <h2>إضافة منتج جديد</h2>
        <form id="add-product-form">
            <input type="text" id="product-name" placeholder="اسم المنتج" required>
            <input type="number" id="product-price" placeholder="السعر" required>
            <input type="text" id="product-img" placeholder="رابط الصورة أو اسم الملف في images/">
            <button type="submit" class="btn">أضف المنتج</button>
        </form>

        <h2>المنتجات الحالية</h2>
        <div id="admin-products-container"></div>

        <h2>الطلبات / المشترين</h2>
        <div id="buyers-container"></div>
    </section>
</main>

<a class="whatsapp-btn" href="https://wa.me/212629568041" target="_blank">
    💬 تواصل معنا
</a>

<script>
// ----------- Admin JS -----------
const form = document.getElementById("add-product-form");
const adminContainer = document.getElementById("admin-products-container");
const buyersContainer = document.getElementById("buyers-container");

// عرض المنتجات
function displayAdminProducts() {
    let products = JSON.parse(localStorage.getItem("products")) || [];
    if(products.length === 0) {
        adminContainer.innerHTML = "<p>لا توجد منتجات حاليا</p>";
        return;
    }
    let html = "<ul>";
    products.forEach((p, index) => {
        html += `<li>
            <span>${p.name} - ${p.price} درهم</span>
            <div>
                <button onclick="editProduct(${index})">تعديل</button>
                <button onclick="deleteProduct(${index})">حذف</button>
            </div>
        </li>`;
    });
    html += "</ul>";
    adminContainer.innerHTML = html;
}

// حذف منتج
function deleteProduct(index) {
    let products = JSON.parse(localStorage.getItem("products")) || [];
    products.splice(index, 1);
    localStorage.setItem("products", JSON.stringify(products));
    displayAdminProducts();
}

// تعديل منتج
function editProduct(index) {
    let products = JSON.parse(localStorage.getItem("products")) || [];
    let p = products[index];
    let newName = prompt("اسم المنتج:", p.name);
    let newPrice = prompt("السعر:", p.price);
    let newImg = prompt("رابط الصورة:", p.img);
    if(newName && newPrice) {
        products[index] = {name:newName, price:parseFloat(newPrice), img:newImg};
        localStorage.setItem("products", JSON.stringify(products));
        displayAdminProducts();
    }
}

// إضافة منتج جديد
form.addEventListener("submit", (e) => {
    e.preventDefault();
    let name = document.getElementById("product-name").value;
    let price = parseFloat(document.getElementById("product-price").value);
    let img = document.getElementById("product-img").value || "images/placeholder.jpg";

    let products = JSON.parse(localStorage.getItem("products")) || [];
    products.push({name, price, img});
    localStorage.setItem("products", JSON.stringify(products));

    form.reset();
    displayAdminProducts();
    alert("تم إضافة المنتج بنجاح!");
});

// عرض المشترين
function displayBuyers() {
    let orders = JSON.parse(localStorage.getItem("orders")) || [];
    if(orders.length === 0) {
        buyersContainer.innerHTML = "<p>لا توجد طلبات حاليا</p>";
        return;
    }
    let html = "<ul>";
    orders.forEach((order, idx) => {
        html += `<li>طلب ${idx+1}:<br>`;
        order.forEach(item => {
            html += `- ${item.name} x ${item.qty} = ${item.price*item.qty} درهم<br>`;
        });
        html += "</li>";
    });
    html += "</ul>";
    buyersContainer.innerHTML = html;
}

document.addEventListener("DOMContentLoaded", () => {
    displayAdminProducts();
    displayBuyers();
});
</script>
</body>
</html>
